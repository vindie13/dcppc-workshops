---
title: "May regstration as of May 9"
author: "Rayna M Harris"
date: "5/9/2018"
output: md_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```


```{r raw, message=FALSE, include=FALSE}
## Load raw data
df <- read_csv("~/Downloads/tito-dcppc-may-data-commons-workshop-tickets-for-rayna-harris-gmail-com-1092292.csv")

# names(df) # view header 
```

```{r annonymize, include=FALSE}
df <- df[-c(24,31),] # drop duplicate registramt
df <- df[c(1,3,5,11,19,28:32,8)] # manually selected for importance

# names(df) # confirm
```

How many incomplete registrants?

```{r incomplete, echo=FALSE}
length(df$`Which Team are you a member of?`[is.na(df$`Which Team are you a member of?`)])
```



```{r factorize, include=FALSE}
##  Make factors
cols <- c(2:9) # character columns to turn to factors
df[cols] <- lapply(df[cols], factor) # set as factor
# sapply(df, class) # confirm
df <- na.omit(df) # drop nas

```

How many total registrants?

```{r totalregistered, echo=FALSE}
length(df$`Which Team are you a member of?`[(df$`Which Team are you a member of?`)])
```


```{r teamnames, echo = F}
df$`Which Team are you a member of?` <- ifelse(grepl("Data Stewards", df$`Which Team are you a member of?`), "Data Stewards",
                  ifelse(grepl("NIH", df$`Which Team are you a member of?`), "NIH",
                  ifelse(grepl("Carbon", df$`Which Team are you a member of?`), "Carbon",
                  ifelse(grepl("Copper", df$`Which Team are you a member of?`), "Copper",
                  ifelse(grepl("Nitrogen", df$`Which Team are you a member of?`), "Nitrogen",
                  ifelse(grepl("Sodium", df$`Which Team are you a member of?`), "Sodium",
                  ifelse(grepl("Xenon", df$`Which Team are you a member of?`), "Xenon",
                  ifelse(grepl("Yttrium", df$`Which Team are you a member of?`), "Yttrium", 
                  ifelse(grepl("Argon", df$`Which Team are you a member of?`), "Argon",
                  ifelse(grepl("Calcium", df$`Which Team are you a member of?`), "Calcium",
                  ifelse(grepl("Helium", df$`Which Team are you a member of?`), "Helium",
                  ifelse(grepl("Oxygen", df$`Which Team are you a member of?`), "Oxygen",
                  ifelse(grepl("Phosphorus", df$`Which Team are you a member of?`), "Phosphorus", "Other")))))))))))))
df$`Which Team are you a member of?` <- as.factor(as.character(df$`Which Team are you a member of?`))
names(df)[7]<-"Team"

```

Summary statistics for may meeting thus far
```{r summarize}
summary(df$`Do you agree to abide by the event Code of Conduct?`) 
summary(df$`Team`)
summary(df$`Do you have any dietary restrictions?`)
summary(df$`Do you agree to video recording?`)
# maybe/unsure shown as `-`
summary(df$`Do you need assistance with childcare (reimbursements, accomdations)?`)
```

```{r names, echo = F}
attendees <- df %>% 
  select(`Ticket Full Name`, `Team`) %>%  
  arrange(`Ticket Full Name`)
attendees <- as.data.frame(attendees)
#attendees
write.csv(attendees, "./data/attendees.csv")
```

```{r childcare, echo = F}
names(df)[10]<-"Childcare"
childcare <- df %>% 
  select(`Ticket Full Name`, `Childcare`) %>%  
  filter(Childcare != "no")
childcare <- as.data.frame(childcare)
#childcare
```

```{r females, include = F}
#This is the percent of females registered
15/36
```


```{r table, include = F}
df <- as.data.frame(df)

## table of registrats
df$`Which Team are you a member of?` <- NULL
summary <- df %>%
  group_by(Team) %>%
  summarize (n = n())
summary <- as.data.frame(summary)

# print attendes by group
for (element in c(levels(factor(df$Team)))) {
  
  print(paste("TEAM", element))
  
  names <- attendees %>% 
  filter(Team %in% c(element))  %>% 
  select(`Ticket Full Name`) %>% 
  arrange(`Ticket Full Name`) %>% 
  droplevels()
  names <- as.data.frame(names[1])
  #avector <- as.vector(aframe['a2'])
  print(names)
  
}
```

Reconciling the may registrants, the Google onboarding form, and their Github handles. 
Of 47 registratns, 24 emails matched the Google 
sheet, and 22 of those have GitHub accounts.

```{r googlesheet, echo = F, message = F, warning =F}
# attendees in the google form with a github account
df1 <- df
df2 <- read.csv("~/Downloads/DCPPC all people Consortium responses to form - Form responses 1.csv")
names(df1)[11]<-"email"
names(df2)[4]<-"email" 

df3 <- left_join(df1, df2, by = "email")
df3 <- df3[c(3,7,19)]  # keep only
names(df3)[3] <- "GitHub"
#df3

```

